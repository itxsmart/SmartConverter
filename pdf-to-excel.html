<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert PDF to Excel Online Free | PDF to XLS XLSX | SmartConverter</title>
    <meta name="description" content="Convert PDF files to Excel spreadsheets (XLS, XLSX) online for free. Extract tables and data from PDFs to editable Excel format." />
    <meta name="keywords" content="PDF to Excel, convert PDF to Excel, PDF to XLS, PDF to XLSX, free PDF converter" />
    <meta name="author" content="SmartConverter Team" />
    <meta name="robots" content="index, follow" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="canonical" href="https://yourwebsite.com/pdf-to-excel.html" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    
    <style>
        /* Missing CSS classes for PDF to Excel converter */
        header {
            background-color: #2c3e50;
            color: white;
            padding: 15px 0;
            height: 100px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-container {
            display:  flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .logo span {
            color: #3498db;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        
        nav ul li a:hover {
            color: #3498db;
        }
        
        .auth-buttons a {
            margin-left: 15px;
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 500;
        }
        
        .login-btn {
            color: white;
            border: 1px solid white;
        }
        
        .register-btn {
            background-color: #3498db;
            color: white;
            border: 1px solid #3498db;
        }
        .extraction-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .table-detection {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .detection-option {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .detection-option:hover {
            background: #f8f9fa;
        }

        .detection-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .sheet-settings {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .sheet-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #667eea;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .preview-table {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .preview-table table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .preview-table th,
        .preview-table td {
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            text-align: left;
        }

        .preview-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .preview-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .conversion-progress {
            display: none;
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .progress-step {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .progress-step.active {
            background: #e8f4fd;
        }

        .progress-step.completed {
            background: #d4edda;
        }

        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #dee2e6;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .step-number.active {
            background: #007bff;
            color: white;
            animation: pulse 1.5s infinite;
        }

        .step-number.completed {
            background: #28a745;
            color: white;
        }

        .download-options {
            display: none;
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .download-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .download-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .download-item:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .download-icon {
            font-size: 2.5rem;
            color: #28a745;
            margin-bottom: 15px;
        }

        .error-alert {
            display: none;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .success-alert {
            display: none;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="index.html" class="logo">Smart<span>Converter</span></a>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="tools.html">Tools</a></li>
                    <!-- <li><a href="#">Pricing</a></li> -->
                    <li><a href="about.html">About Us</a></li>
                    <!-- <li><a href="#">Contact</a></li> -->
                    <li><a href="index.html">Dashboard</a></li>
                </ul>
            </nav>
            <!-- <div class="auth-buttons">
                <a href="#" class="login-btn">Sign In</a>
                <a href="#" class="register-btn">Register</a>
            </div> -->
        </div>
    </header>
    <div class="container">
        <div class="header">
            <div class="tool-icon">
                <i class="fas fa-file-excel"></i>
            </div>
            <h1>PDF to Excel Converter</h1>
            <p>Convert your PDF documents to Excel spreadsheets with table detection and data extraction</p>
        </div>

        <div class="main-card">
            <!-- File Upload Section -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <div class="upload-text">
                    <h3>Drop PDF files here or click to browse</h3>
                    <p>Supports PDF files up to 50MB</p>
                </div>
                <input type="file" id="fileInput" accept=".pdf" multiple style="display: none;">
            </div>

            <!-- File List -->
            <div class="file-list" id="fileList" style="display: none;">
                <!-- Files will be added here dynamically -->
            </div>

            <!-- Extraction Options -->
            <div class="extraction-options" id="extractionOptions" style="display: none;">
                <div class="table-detection">
                    <h3><i class="fas fa-table"></i> Table Detection</h3>
                    <div class="detection-option">
                        <input type="radio" name="detection" value="auto" id="autoDetect" checked>
                        <label for="autoDetect">
                            <strong>Auto Detect Tables</strong><br>
                            <small>Automatically find and extract tables</small>
                        </label>
                    </div>
                    <div class="detection-option">
                        <input type="radio" name="detection" value="manual" id="manualDetect">
                        <label for="manualDetect">
                            <strong>Manual Selection</strong><br>
                            <small>Select specific areas to extract</small>
                        </label>
                    </div>
                    <div class="detection-option">
                        <input type="radio" name="detection" value="all" id="allText">
                        <label for="allText">
                            <strong>All Text</strong><br>
                            <small>Extract all text as data</small>
                        </label>
                    </div>
                </div>

                <div class="sheet-settings">
                    <h3><i class="fas fa-cog"></i> Excel Settings</h3>
                    <div class="sheet-option">
                        <span>
                            <strong>Preserve Formatting</strong><br>
                            <small>Keep original text formatting</small>
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="preserveFormat" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="sheet-option">
                        <span>
                            <strong>Merge Similar Tables</strong><br>
                            <small>Combine tables with same structure</small>
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mergeTables">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="sheet-option">
                        <span>
                            <strong>Create Separate Sheets</strong><br>
                            <small>One sheet per PDF page</small>
                        </span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="separateSheets">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Table Preview -->
            <div class="preview-table" id="tablePreview" style="display: none;">
                <h3><i class="fas fa-eye"></i> Data Preview</h3>
                <div id="previewContent">
                    <!-- Preview will be shown here -->
                </div>
            </div>

            <!-- Conversion Progress -->
            <div class="conversion-progress" id="conversionProgress">
                <h3><i class="fas fa-sync fa-spin"></i> Converting to Excel...</h3>
                <div class="progress-step" id="step1">
                    <div class="step-number">1</div>
                    <div>
                        <strong>Reading PDF</strong><br>
                        <small>Analyzing document structure...</small>
                    </div>
                </div>
                <div class="progress-step" id="step2">
                    <div class="step-number">2</div>
                    <div>
                        <strong>Detecting Tables</strong><br>
                        <small>Finding tabular data...</small>
                    </div>
                </div>
                <div class="progress-step" id="step3">
                    <div class="step-number">3</div>
                    <div>
                        <strong>Extracting Data</strong><br>
                        <small>Converting to Excel format...</small>
                    </div>
                </div>
                <div class="progress-step" id="step4">
                    <div class="step-number">4</div>
                    <div>
                        <strong>Finalizing</strong><br>
                        <small>Preparing download...</small>
                    </div>
                </div>
            </div>

            <!-- Download Options -->
            <div class="download-options" id="downloadOptions">
                <h3><i class="fas fa-download"></i> Download Your Excel Files</h3>
                <div class="download-grid" id="downloadGrid">
                    <!-- Download links will be added here -->
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="convertBtn" style="display: none;">
                    <i class="fas fa-file-excel"></i>
                    Convert to Excel
                </button>
                <button class="btn btn-secondary" id="resetBtn" style="display: none;">
                    <i class="fas fa-redo"></i>
                    Start Over
                </button>
                <button class="btn btn-primary" id="downloadAllBtn" style="display: none;">
                    <i class="fas fa-download"></i>
                    Download All
                </button>
            </div>

            <!-- Error/Success Messages -->
            <div class="error-alert" id="errorAlert">
                <i class="fas fa-exclamation-triangle"></i>
                <span id="errorMessage"></span>
            </div>

            <div class="success-alert" id="successAlert">
                <i class="fas fa-check-circle"></i>
                <span id="successMessage"></span>
            </div>

            <!-- Security Note -->
            <div class="security-note">
                <i class="fas fa-shield-alt"></i>
                Your files are processed locally in your browser. No data is sent to external servers.
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let uploadedFiles = [];
        let extractedData = [];
        let conversionResults = [];

        // PDF.js worker setup
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        // DOM elements
        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const fileList = document.getElementById('fileList');
        const extractionOptions = document.getElementById('extractionOptions');
        const tablePreview = document.getElementById('tablePreview');
        const conversionProgress = document.getElementById('conversionProgress');
        const downloadOptions = document.getElementById('downloadOptions');
        const convertBtn = document.getElementById('convertBtn');
        const resetBtn = document.getElementById('resetBtn');
        const downloadAllBtn = document.getElementById('downloadAllBtn');
        const errorAlert = document.getElementById('errorAlert');
        const successAlert = document.getElementById('successAlert');

        // Event listeners
        uploadZone.addEventListener('click', () => fileInput.click());
        uploadZone.addEventListener('dragover', handleDragOver);
        uploadZone.addEventListener('drop', handleDrop);
        fileInput.addEventListener('change', handleFileSelect);
        convertBtn.addEventListener('click', startConversion);
        resetBtn.addEventListener('click', resetConverter);
        downloadAllBtn.addEventListener('click', downloadAllFiles);

        // File handling functions
        function handleDragOver(e) {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files).filter(file => file.type === 'application/pdf');
            processFiles(files);
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            processFiles(files);
        }

        function processFiles(files) {
            if (files.length === 0) {
                showError('Please select valid PDF files.');
                return;
            }

            uploadedFiles = files;
            displayFileList();
            showExtractionOptions();
        }

        function displayFileList() {
            fileList.style.display = 'block';
            fileList.innerHTML = '';

            uploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <i class="fas fa-file-pdf file-icon"></i>
                        <div class="file-details">
                            <h4>${file.name}</h4>
                            <p>${formatFileSize(file.size)} • PDF Document</p>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="btn-danger" onclick="removeFile(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            if (uploadedFiles.length === 0) {
                fileList.style.display = 'none';
                extractionOptions.style.display = 'none';
                convertBtn.style.display = 'none';
            } else {
                displayFileList();
            }
        }

        function showExtractionOptions() {
            extractionOptions.style.display = 'block';
            convertBtn.style.display = 'inline-flex';
            resetBtn.style.display = 'inline-flex';
        }

        // Conversion functions
        async function startConversion() {
            try {
                showProgress();
                conversionResults = [];

                for (let i = 0; i < uploadedFiles.length; i++) {
                    updateProgressStep(1, true);
                    const pdfData = await readPDFFile(uploadedFiles[i]);
                    
                    updateProgressStep(2, true);
                    const tablesData = await extractTablesFromPDF(pdfData);
                    
                    updateProgressStep(3, true);
                    const excelFile = await createExcelFile(tablesData, uploadedFiles[i].name);
                    
                    conversionResults.push({
                        filename: uploadedFiles[i].name.replace('.pdf', '.xlsx'),
                        data: excelFile,
                        originalFile: uploadedFiles[i].name
                    });
                }

                updateProgressStep(4, true);
                await new Promise(resolve => setTimeout(resolve, 1000));

                showDownloadOptions();
                showSuccess(`Successfully converted ${uploadedFiles.length} PDF file(s) to Excel!`);
            } catch (error) {
                console.error('Conversion error:', error);
                showError('An error occurred during conversion. Please try again.');
            }
        }

        async function readPDFFile(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
            
            const pages = [];
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                pages.push(textContent);
            }
            
            return pages;
        }

        async function extractTablesFromPDF(pdfData) {
            const detectionMode = document.querySelector('input[name="detection"]:checked').value;
            const tables = [];

            for (let pageIndex = 0; pageIndex < pdfData.length; pageIndex++) {
                const textContent = pdfData[pageIndex];
                
                if (detectionMode === 'all') {
                    // Extract all text as single table
                    const allText = textContent.items.map(item => item.str).join(' ');
                    tables.push({
                        page: pageIndex + 1,
                        data: [allText.split(/\s+/)],
                        type: 'text'
                    });
                } else {
                    // Try to detect tabular structures
                    const detectedTables = detectTables(textContent);
                    tables.push(...detectedTables.map(table => ({
                        page: pageIndex + 1,
                        data: table,
                        type: 'table'
                    })));
                }
            }

            return tables;
        }

        function detectTables(textContent) {
            // Simple table detection algorithm
            // This is a basic implementation - in production, you'd use more sophisticated methods
            const lines = [];
            let currentLine = [];
            let lastY = null;

            textContent.items.forEach(item => {
                if (lastY !== null && Math.abs(item.transform[5] - lastY) > 5) {
                    if (currentLine.length > 0) {
                        lines.push(currentLine.sort((a, b) => a.transform[4] - b.transform[4]));
                        currentLine = [];
                    }
                }
                currentLine.push(item);
                lastY = item.transform[5];
            });

            if (currentLine.length > 0) {
                lines.push(currentLine.sort((a, b) => a.transform[4] - b.transform[4]));
            }

            // Convert lines to table rows
            const tableData = lines.map(line => line.map(item => item.str));
            
            // Filter out lines that are too short to be table rows
            return [tableData.filter(row => row.length > 1)];
        }

        async function createExcelFile(tablesData, originalFilename) {
            const workbook = XLSX.utils.book_new();
            const separateSheets = document.getElementById('separateSheets').checked;

            if (separateSheets) {
                // Create separate sheet for each page
                tablesData.forEach((table, index) => {
                    const worksheetName = `Page_${table.page}`;
                    const worksheet = XLSX.utils.aoa_to_sheet(table.data);
                    XLSX.utils.book_append_sheet(workbook, worksheet, worksheetName);
                });
            } else {
                // Combine all tables into one sheet
                let allData = [];
                tablesData.forEach(table => {
                    if (allData.length > 0) {
                        allData.push([]); // Empty row separator
                        allData.push([`--- Page ${table.page} ---`]);
                        allData.push([]);
                    }
                    allData.push(...table.data);
                });
                
                const worksheet = XLSX.utils.aoa_to_sheet(allData);
                XLSX.utils.book_append_sheet(workbook, worksheet, 'Extracted_Data');
            }

            return XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
        }

        // UI helper functions
        function showProgress() {
            conversionProgress.style.display = 'block';
            convertBtn.disabled = true;
            resetAllProgressSteps();
        }

        function updateProgressStep(stepNumber, active = false, completed = false) {
            const step = document.getElementById(`step${stepNumber}`);
            const stepNumberEl = step.querySelector('.step-number');
            
            step.classList.remove('active', 'completed');
            stepNumberEl.classList.remove('active', 'completed');
            
            if (completed) {
                step.classList.add('completed');
                stepNumberEl.classList.add('completed');
                stepNumberEl.innerHTML = '<i class="fas fa-check"></i>';
            } else if (active) {
                step.classList.add('active');
                stepNumberEl.classList.add('active');
            }
        }

        function resetAllProgressSteps() {
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step${i}`);
                const stepNumberEl = step.querySelector('.step-number');
                step.classList.remove('active', 'completed');
                stepNumberEl.classList.remove('active', 'completed');
                stepNumberEl.textContent = i;
            }
        }

        function showDownloadOptions() {
            conversionProgress.style.display = 'none';
            downloadOptions.style.display = 'block';
            downloadAllBtn.style.display = 'inline-flex';
            
            const downloadGrid = document.getElementById('downloadGrid');
            downloadGrid.innerHTML = '';

            conversionResults.forEach((result, index) => {
                const downloadItem = document.createElement('div');
                downloadItem.className = 'download-item';
                downloadItem.innerHTML = `
                    <div class="download-icon">
                        <i class="fas fa-file-excel"></i>
                    </div>
                    <h4>${result.filename}</h4>
                    <p>From: ${result.originalFile}</p>
                    <button class="btn btn-primary" onclick="downloadFile(${index})">
                        <i class="fas fa-download"></i> Download
                    </button>
                `;
                downloadGrid.appendChild(downloadItem);
            });
        }

        function downloadFile(index) {
            const result = conversionResults[index];
            const blob = new Blob([result.data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = result.filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadAllFiles() {
            conversionResults.forEach((result, index) => {
                setTimeout(() => downloadFile(index), index * 100);
            });
        }

        function resetConverter() {
            uploadedFiles = [];
            extractedData = [];
            conversionResults = [];
            
            fileList.style.display = 'none';
            extractionOptions.style.display = 'none';
            tablePreview.style.display = 'none';
            conversionProgress.style.display = 'none';
            downloadOptions.style.display = 'none';
            
            convertBtn.style.display = 'none';
            resetBtn.style.display = 'none';
            downloadAllBtn.style.display = 'none';
            
            hideMessages();
            fileInput.value = '';
        }

        function showError(message) {
            errorAlert.style.display = 'block';
            document.getElementById('errorMessage').textContent = message;
            successAlert.style.display = 'none';
            setTimeout(hideMessages, 5000);
        }

        function showSuccess(message) {
            successAlert.style.display = 'block';
            document.getElementById('successMessage').textContent = message;
            errorAlert.style.display = 'none';
            setTimeout(hideMessages, 5000);
        }

        function hideMessages() {
            errorAlert.style.display = 'none';
            successAlert.style.display = 'none';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
    </script>
</body>
</html>